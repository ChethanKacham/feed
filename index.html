<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
<title>Feed Player - For Images, Video and Text</title>

<script type="text/javascript" src="https://model.earth/localsite/js/localsite.js?showheader=true"></script>

<script type="module" crossorigin src="dist/assets/feedplayer.js"></script>
<link rel="stylesheet" crossorigin href="dist/assets/feedplayer.css">

<script>

loadMarkdown("/feed/README.md", "readmeDiv", "_parent");

window.onload = function() {
  if (performance.navigation.type === 1) {
    // This is a page refresh
    history.replaceState(null, null, ' ');
  }
};

</script>

<style>
  .swiper-section {
    height: 300px;
    width: 100%;
    overflow: hidden;
    margin-bottom:0;
  }
</style>

</head>

<body>

<!-- Yarn Dev is still using index.html.
  Change it to use feedplayer.html like Yarn Build does. -->
<div id="root"><img src="src/assets/images/intro-a.jpg" style="border-radius:20px;"><div style="margin-top:20px;z-index:1000">Broken by build. Manually update the index .js and .css files to include the newly built ID values.</div></div>

<object type="text/html" class="swiper-section" data="/swiper/dist/loop.html" scrolling="no"></object>

<div class="content contentpadding large-list" style="padding-top:0px">
  <div id="readmeDiv"></div>
</div>

<script>
  window.addEventListener('load', function() {
    if (performance.navigation.type === 1) {
      // This is a page refresh
      history.replaceState(null, null, ' ');
    }
  });

  window.addEventListener('message', (event) => {
    // Verify the origin
    if (event.origin === 'https://raydendarkus.github.io' || event.origin === 'http://localhost:8887' || event.origin === 'https://model.earth/') {
      const { index, source } = event.data;
      console.log('Received message:', index, source);
      // Check if the message is from the swiper iframe
      if (source === 'loop' && index) {
        window.location.hash = `#feed=nasa&scene=${index}`;
      }
    } else {
      console.warn('Unexpected origin:', event.origin);
    }
  });
</script>
</body>
</html>