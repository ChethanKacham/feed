<!doctype html>
<html lang="en">
<head>
  <!-- feedplayer.html is sent to dist/index.html during Yarn Build -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="favicons/site.webmanifest">
  <link rel="mask-icon" href="favicons/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>Feed Player</title>

  <script type="text/javascript" src="https://model.earth/localsite/js/localsite.js?showheader=true"></script>
  
  <script>
  
  loadMarkdown("/feed/README.md", "readmeDiv", "_parent");

  window.onload = function() {
    if (performance.navigation.type === 1) {
      // This is a page refresh
      history.replaceState(null, null, ' ');
    }
  };

  </script>

  <style>
    .swiper-section {
      height: 300px;
      width: 100%;
      overflow: hidden;
      margin-bottom:0;
    }
    </style>

</head>

<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
  <object type="text/html" class="swiper-section" data="/swiper/dist/loop.html" scrolling="no"></object>

  <div class="content contentpadding large-list" style="padding-top:10px">
    <div id="readmeDiv"></div>
  </div>

<script>
  window.addEventListener('load', function() {
    if (performance.navigation.type === 1) {
      // This is a page refresh
      history.replaceState(null, null, ' ');
    }
  });

  window.addEventListener('message', (event) => {
    // Verify the origin
    if (event.origin === 'https://model.earth/' || event.origin === 'https://raydendarkus.github.io' || event.origin === 'http://localhost:8887') {
      const { index, source } = event.data;
      console.log('Received message:', index, source);
      // Check if the message is from the swiper iframe
      if (source === 'loop' && index) {
        window.location.hash = `#feed=nasa&scene=${index}`;
      }
    } else {
      console.warn('Unexpected origin:', event.origin);
    }
  });
</script>

</body>

</html>